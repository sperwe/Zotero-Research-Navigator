# 完整版本 - v2.0.3-complete

## 实现的5大核心功能

### 1. ✅ 标签页监听和追踪
- 监听标签页打开/关闭/切换事件
- 自动记录从哪个文献跳转到哪个文献
- 保持标签页与节点的映射关系

### 2. ✅ 修复文献打开功能
- 使用 `ZoteroPane.selectItem()` 选中文献
- 使用 `Zotero.OpenPDF.openToPage()` 打开PDF
- 双击树节点可正确打开对应文献

### 3. ✅ 真正的路径追踪
- 自动追踪用户的浏览路径
- 基于时间判断父子关系（5秒内）
- 支持手动添加到研究路径
- 记录访问次数

### 4. ✅ 导航控制
- **工具栏导航按钮**：
  - ← 后退：返回上一个访问的文献
  - → 前进：前进到下一个文献
  - ↑ 父节点：跳转到父文献
  - 🌳 树视图：切换树形面板
- **导航历史栈**：维护完整的访问历史
- **按钮状态管理**：根据当前位置启用/禁用按钮

### 5. ✅ 识别文献之间的关系
- **7种关系类型**：
  - 👆 手动导航（Manual）
  - 📎 引用关系（Citation）
  - 👤 相同作者（Author）
  - 🏷️ 共同标签（Tag）
  - 📁 同一文件夹（Collection）
  - 🔗 相关文献（Related）
  - ⏱️ 时间关系（Temporal）
- **自动识别**：分析文献之间的关系
- **图标显示**：在树中显示关系类型

## 新增功能

### 导航工具栏
- 直接集成到 Zotero 工具栏
- 前进/后退/父节点导航
- 快速访问树形视图

### 增强的右键菜单
- "Add to Research Path"：添加到当前路径
- "Start New Research Path Here"：作为新路径开始

### 关系图例
- 点击 "Legend" 按钮查看所有关系类型说明
- 鼠标悬停显示关系含义

### 改进的树形显示
- 显示关系类型图标
- 更紧凑的标题显示（40字符）
- 完整信息在悬停提示中

## 使用说明

### 1. 自动追踪
- 打开文献时自动记录
- 快速切换（5秒内）形成父子关系
- 识别文献之间的关系

### 2. 导航操作
- 使用工具栏按钮快速导航
- 双击树节点打开文献
- 右键菜单手动管理路径

### 3. 查看关系
- 树中的小图标表示关系类型
- 悬停查看具体说明
- Legend 按钮查看所有类型

## 技术实现

- 使用 `Zotero.Notifier` 监听事件
- 分析文献元数据判断关系
- 维护导航历史栈
- 标签页与节点映射

## 已知限制

- 引用关系检测需要进一步完善（需要解析PDF）
- 数据仅存储在内存中
- 标签页API可能需要根据Zotero版本调整

---
版本：v2.0.3-complete
日期：2025-01-27
状态：核心功能全部实现