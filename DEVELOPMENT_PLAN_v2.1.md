# Research Navigator v2.1.0 å¼€å‘è®¡åˆ’

## ğŸ“‹ æ¦‚è¿°

æœ¬å¼€å‘è®¡åˆ’èšç„¦äºä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½çš„å®ç°ï¼š
1. **é›†æˆå·²å…³é—­æ ‡ç­¾é¡µå†å²** - è¿½è¸ªå’Œæ¢å¤å·²å…³é—­çš„ç ”ç©¶æ ‡ç­¾é¡µ
2. **å†å²å¯¼èˆªä¸ç¬”è®°åŒå‘å…³è”ç³»ç»Ÿ** - å»ºç«‹ç ”ç©¶è·¯å¾„ä¸ç¬”è®°ä¹‹é—´çš„æ™ºèƒ½è¿æ¥

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

- æä¾›å®Œæ•´çš„ç ”ç©¶è·¯å¾„è¿½è¸ªï¼ŒåŒ…æ‹¬å·²å…³é—­çš„æ ‡ç­¾é¡µ
- å»ºç«‹ç¬”è®°ä¸å†å²çš„åŒå‘å…³è”ï¼Œå¢å¼ºç ”ç©¶çš„å¯è¿½æº¯æ€§
- ä¿æŒä¸ Zotero ç”Ÿæ€ç³»ç»Ÿçš„æ— ç¼é›†æˆ
- æä¾›ç›´è§‚ã€é«˜æ•ˆçš„ç”¨æˆ·ç•Œé¢

## ğŸ—ï¸ UI æ¶æ„è®¾è®¡

### æ¨èæ–¹æ¡ˆï¼šæ··åˆå¼ UIï¼ˆæ–¹æ¡ˆ A + B çš„ç»“åˆï¼‰

1. **ä¸»è¦ç•Œé¢**ï¼šå¢å¼ºç°æœ‰æµ®åŠ¨é¢æ¿
   - æ·»åŠ æ ‡ç­¾é¡µåˆ‡æ¢ï¼šå†å²æ ‘ | å·²å…³é—­ | ç¬”è®°å…³è”
   - ä¿æŒå¿«é€Ÿè®¿é—®çš„ä¾¿åˆ©æ€§

2. **æ‰©å±•ç•Œé¢**ï¼šå¯é€‰çš„ä¾§è¾¹æ æ¨¡å¼
   - ç”¨æˆ·å¯ä»¥é€‰æ‹©å°†é¢æ¿"åœé "åˆ° Zotero ä¾§è¾¹æ 
   - æä¾›æ›´å¤§çš„æ˜¾ç¤ºç©ºé—´ç”¨äºå¤æ‚æ“ä½œ

3. **å±•ç¤ºæ¨¡å¼**ï¼š
   - å·²å…³é—­æ ‡ç­¾é¡µé‡‡ç”¨æ ‘å½¢å±•ç¤ºï¼ˆç±»ä¼¼ Tree Style Historyï¼‰
   - æ”¯æŒæ—¶é—´åˆ†ç»„ï¼ˆä»Šå¤©ã€æ˜¨å¤©ã€æœ¬å‘¨ç­‰ï¼‰
   - è§†è§‰åŒºåˆ†ï¼šä½¿ç”¨ç°è‰²å›¾æ ‡å’Œè™šçº¿è¾¹æ¡†

---

## ğŸ“… ç¬¬ä¸€é˜¶æ®µï¼šå·²å…³é—­æ ‡ç­¾é¡µå†å²ï¼ˆç¬¬1å‘¨ï¼‰

### Day 1-2: æ•°æ®æ¨¡å‹å’ŒåŸºç¡€æ¶æ„

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] æ‰©å±•æ•°æ®åº“ schemaï¼Œæ·»åŠ æ ‡ç­¾é¡µçŠ¶æ€å­—æ®µ
- [ ] åˆ›å»º `ClosedTabsManager` ç±»
- [ ] å®ç°ä¸ `Zotero_Tabs._history` çš„æ•°æ®åŒæ­¥
- [ ] è®¾è®¡å·²å…³é—­èŠ‚ç‚¹çš„æ•°æ®ç»“æ„

**æŠ€æœ¯è¦ç‚¹**ï¼š
```javascript
// èŠ‚ç‚¹çŠ¶æ€æ‰©å±•
NodeStatus = {
  OPEN: 'open',
  CLOSED: 'closed',
  RESTORED: 'restored'
}

// å…³é—­ä¸Šä¸‹æ–‡
ClosedContext = {
  closedAt: timestamp,
  closedFrom: nodeId,
  sessionId: string,
  tabIndex: number
}
```

### Day 3-4: UI å®ç°

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åœ¨æµ®åŠ¨é¢æ¿æ·»åŠ "å·²å…³é—­"æ ‡ç­¾é¡µ
- [ ] å®ç°å·²å…³é—­æ ‡ç­¾é¡µçš„æ ‘å½¢è§†å›¾
- [ ] è®¾è®¡è§†è§‰æ ·å¼ï¼ˆç°è‰²ä¸»é¢˜ã€å›¾æ ‡å˜åŒ–ï¼‰
- [ ] æ·»åŠ æ—¶é—´åˆ†ç»„åŠŸèƒ½

**UI è§„èŒƒ**ï¼š
```css
/* å·²å…³é—­èŠ‚ç‚¹æ ·å¼ */
.closed-node {
  opacity: 0.6;
  border: 1px dashed #ccc;
}
.closed-node-icon {
  filter: grayscale(100%);
}
```

### Day 5: æ¢å¤åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç°åŒå‡»æ¢å¤åŠŸèƒ½
- [ ] æ·»åŠ å³é”®èœå•"æ¢å¤æ ‡ç­¾é¡µ"
- [ ] è°ƒç”¨ `Zotero_Tabs.undoClose()` API
- [ ] æ›´æ–°èŠ‚ç‚¹çŠ¶æ€å’Œè§†è§‰åé¦ˆ

### Day 6-7: ä¼˜åŒ–å’Œæµ‹è¯•

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] æ‰¹é‡æ¢å¤åŠŸèƒ½
- [ ] è‡ªåŠ¨æ¸…ç†è¿‡æœŸè®°å½•ï¼ˆå¯é…ç½®ï¼‰
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¤§é‡å·²å…³é—­æ ‡ç­¾é¡µï¼‰
- [ ] å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸ“… ç¬¬äºŒé˜¶æ®µï¼šç¬”è®°å…³è”ç³»ç»Ÿï¼ˆç¬¬2-3å‘¨ï¼‰

### Week 2, Day 1-2: æ•°æ®æ¶æ„

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åˆ›å»ºç¬”è®°å…³è”è¡¨
- [ ] å®ç° `NoteHistoryRelation` ç±»
- [ ] è®¾è®¡å…³è”ç±»å‹ç³»ç»Ÿ
- [ ] æ•°æ®è¿ç§»å’Œå…¼å®¹æ€§å¤„ç†

**æ•°æ®æ¨¡å‹**ï¼š
```sql
CREATE TABLE research_navigator_note_relations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    noteId INTEGER NOT NULL,
    nodeId TEXT NOT NULL,
    relationType TEXT DEFAULT 'created_during',
    createdAt INTEGER NOT NULL,
    context TEXT, -- JSON
    UNIQUE(noteId, nodeId)
);
```

### Week 2, Day 3-4: è‡ªåŠ¨å…³è”æœºåˆ¶

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] ç›‘å¬ç¬”è®°åˆ›å»ºäº‹ä»¶
- [ ] æ•è·å½“å‰å†å²ä¸Šä¸‹æ–‡
- [ ] å®ç°è‡ªåŠ¨å…³è”é€»è¾‘
- [ ] å¤„ç†è¾¹ç¼˜æƒ…å†µï¼ˆæ‰¹é‡å¯¼å…¥ç­‰ï¼‰

### Week 2, Day 5-7: å†å²è§†å›¾ UI

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åœ¨å†å²èŠ‚ç‚¹æ˜¾ç¤ºç¬”è®°æ•°é‡å¾½ç« 
- [ ] å®ç°ç¬”è®°é¢„è§ˆæ‚¬æµ®çª—
- [ ] åˆ›å»ºå…³è”ç¬”è®°åˆ—è¡¨é¢æ¿
- [ ] æ·»åŠ å¿«é€Ÿåˆ›å»ºç¬”è®°å…¥å£

**UI è®¾è®¡**ï¼š
```
å†å²èŠ‚ç‚¹
â”œâ”€ ğŸ“„ æ–‡çŒ®æ ‡é¢˜ [3] â† ç¬”è®°æ•°é‡å¾½ç« 
â”‚   â”œâ”€ ğŸ“ ç ”ç©¶ç¬”è®°
â”‚   â”œâ”€ ğŸ“ å®éªŒè®°å½•
â”‚   â””â”€ ğŸ“ é—®é¢˜æ€»ç»“
â””â”€ ğŸ”— ç›¸å…³æ–‡çŒ®
```

### Week 3, Day 1-2: ç¬”è®°è§†å›¾é›†æˆ

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åœ¨ç¬”è®°ç¼–è¾‘å™¨æ·»åŠ å†å²ä¿¡æ¯æ 
- [ ] æ˜¾ç¤ºåˆ›å»ºè·¯å¾„å’Œæ—¶é—´
- [ ] å®ç°"è·³è½¬åˆ°å†å²"åŠŸèƒ½
- [ ] æ”¯æŒä¿®æ”¹å…³è”å…³ç³»

### Week 3, Day 3-4: æ‰‹åŠ¨ç®¡ç†åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å…³è”ç°æœ‰ç¬”è®°å¯¹è¯æ¡†
- [ ] æ‹–æ‹½å…³è”æ”¯æŒ
- [ ] æ‰¹é‡æ“ä½œç•Œé¢
- [ ] å…³è”ç±»å‹é€‰æ‹©å™¨

### Week 3, Day 5-7: æœç´¢å’Œå¯¼èˆª

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] æ•´åˆç¬”è®°å†…å®¹åˆ°æœç´¢
- [ ] å®ç°åŒå‘å¯¼èˆªå¿«æ·é”®
- [ ] æ·»åŠ å…³è”å…³ç³»å¯è§†åŒ–
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•

---

## ğŸ“… ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½å’Œä¼˜åŒ–ï¼ˆç¬¬4å‘¨ï¼‰

### Day 1-2: æ™ºèƒ½åŠŸèƒ½

**åŠŸèƒ½åˆ—è¡¨**ï¼š
- [ ] ç›¸ä¼¼è·¯å¾„æ£€æµ‹å’Œæ¨è
- [ ] ç¬”è®°å®Œæ•´æ€§æé†’
- [ ] è‡ªåŠ¨æ ‡ç­¾å»ºè®®
- [ ] ç ”ç©¶æ¨¡å¼è¯†åˆ«

### Day 3-4: å¯¼å‡ºå’ŒæŠ¥å‘Š

**åŠŸèƒ½åˆ—è¡¨**ï¼š
- [ ] ç ”ç©¶è·¯å¾„å¯¼å‡ºï¼ˆå«ç¬”è®°ï¼‰
- [ ] æ—¶é—´çº¿ç”Ÿæˆ
- [ ] Markdown æŠ¥å‘Š
- [ ] å›¾è¡¨å¯è§†åŒ–

### Day 5-7: æ€§èƒ½å’Œç¨³å®šæ€§

**ä¼˜åŒ–ä»»åŠ¡**ï¼š
- [ ] å¤§æ•°æ®é›†ä¼˜åŒ–
- [ ] å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- [ ] å¯åŠ¨é€Ÿåº¦ä¼˜åŒ–
- [ ] é”™è¯¯å¤„ç†å®Œå–„

---

## ğŸ“Š æŠ€æœ¯è§„èŒƒ

### API ä½¿ç”¨

1. **Zotero åŸç”Ÿ API**ï¼š
   - `Zotero_Tabs._history` - å·²å…³é—­æ ‡ç­¾é¡µæ•°æ®
   - `Zotero_Tabs.undoClose()` - æ¢å¤æ ‡ç­¾é¡µ
   - `Zotero.Notifier` - äº‹ä»¶ç›‘å¬
   - `Zotero.Items` - ç¬”è®°æ“ä½œ

2. **äº‹ä»¶ç›‘å¬**ï¼š
   ```javascript
   // æ ‡ç­¾é¡µäº‹ä»¶
   Zotero.Notifier.registerObserver({
     notify: (event, type, ids, extraData) => {
       if (type === 'tab') {
         switch(event) {
           case 'close': handleTabClose(ids); break;
           case 'select': handleTabSelect(ids); break;
         }
       }
     }
   }, ['tab', 'item'], 'ResearchNavigator');
   ```

### æ€§èƒ½æŒ‡æ ‡

- å†å²åŠ è½½æ—¶é—´ï¼š< 500ms
- å…³è”æŸ¥è¯¢å“åº”ï¼š< 100ms
- å†…å­˜å ç”¨å¢é•¿ï¼š< 20%
- UI å“åº”æ—¶é—´ï¼š< 50ms

---

## ğŸš€ å‘å¸ƒè®¡åˆ’

### v2.1.0-beta.1ï¼ˆç¬¬2å‘¨æœ«ï¼‰
- å·²å…³é—­æ ‡ç­¾é¡µåŸºç¡€åŠŸèƒ½
- åŸºç¡€ UI å®ç°

### v2.1.0-beta.2ï¼ˆç¬¬3å‘¨æœ«ï¼‰
- å®Œæ•´çš„ç¬”è®°å…³è”ç³»ç»Ÿ
- åŒå‘å¯¼èˆªåŠŸèƒ½

### v2.1.0-rc.1ï¼ˆç¬¬4å‘¨ä¸­ï¼‰
- æ‰€æœ‰åŠŸèƒ½å®Œæˆ
- æ€§èƒ½ä¼˜åŒ–

### v2.1.0ï¼ˆç¬¬5å‘¨ï¼‰
- æ­£å¼å‘å¸ƒ
- å®Œæ•´æ–‡æ¡£

---

## ğŸ“ é£é™©ç®¡ç†

1. **API å…¼å®¹æ€§**ï¼š
   - é£é™©ï¼šZotero æ›´æ–°å¯èƒ½æ”¹å˜å†…éƒ¨ API
   - ç¼“è§£ï¼šæ·»åŠ  API ç‰ˆæœ¬æ£€æŸ¥ï¼Œæä¾›é™çº§æ–¹æ¡ˆ

2. **æ€§èƒ½é—®é¢˜**ï¼š
   - é£é™©ï¼šå¤§é‡å†å²æ•°æ®å½±å“æ€§èƒ½
   - ç¼“è§£ï¼šå®ç°åˆ†é¡µåŠ è½½ï¼Œæ•°æ®æ¸…ç†æœºåˆ¶

3. **UI å†²çª**ï¼š
   - é£é™©ï¼šä¸å…¶ä»–æ’ä»¶çš„ UI å†²çª
   - ç¼“è§£ï¼šä½¿ç”¨ç‹¬ç«‹çš„å‘½åç©ºé—´ï¼Œæä¾›é…ç½®é€‰é¡¹

---

## âœ… æˆåŠŸæ ‡å‡†

1. **åŠŸèƒ½å®Œæ•´æ€§**ï¼š
   - æ‰€æœ‰å·²å…³é—­æ ‡ç­¾é¡µå¯è¿½è¸ªå’Œæ¢å¤
   - ç¬”è®°å…³è”å‡†ç¡®æ— é—æ¼
   - åŒå‘å¯¼èˆªæµç•…è‡ªç„¶

2. **ç”¨æˆ·ä½“éªŒ**ï¼š
   - å­¦ä¹ æˆæœ¬ä½
   - æ“ä½œç›´è§‚
   - å“åº”è¿…é€Ÿ

3. **ç¨³å®šæ€§**ï¼š
   - æ— æ•°æ®ä¸¢å¤±
   - é”™è¯¯å¤„ç†å®Œå–„
   - å‘åå…¼å®¹

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯æ¶æ„æ–‡æ¡£](./ARCHITECTURE.md)
- [API å‚è€ƒæ–‡æ¡£](./API_REFERENCE.md)
- [ç”¨æˆ·ä½¿ç”¨æŒ‡å—](./USER_GUIDE.md)
- [è´¡çŒ®æŒ‡å—](./CONTRIBUTING.md)